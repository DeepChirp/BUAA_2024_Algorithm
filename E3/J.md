# 2024-两点间最短距离

时间限制：1000 ms / 空间限制：131072 KB / 难度：8

## 题目描述

给出 $n$ 个结点 $m$ 条边的**有向无环带权图**，结点依次标号 $1$ 至 $n$，第 $i$ 条边由结点 $a_i$ 连向 $b_i$，长度为 $w_i$。

给出 $q$ 次询问，第 $i$ 次询问会选择三个结点 $u_i$，$v_i$ 与 $s_i$，你需要求出在**不经过** $s_i$ 的条件下从 $u_i$ 到 $v_i$ 的最短距离。

如果在**不经过** $s_i$ 的条件下**不能**从 $u_i$ 到达 $v_i$，我们认为答案为 $0$。

每次询问后需要你立刻求出答案，因此你在读取 $u_i,v_i,s_i$ 后需要对这三个值进行以下操作以得到正确的输入：

$$
\begin{aligned}
u_i&=(u_i+\text{last})\bmod n+1\\
v_i&=(v_i+\text{last})\bmod n+1\\
s_i&=(s_i+\text{last})\bmod n+1
\end{aligned}
$$

其中 $\text{last}$ 表示上一次询问的答案。如果之前没有询问，那么 $\text{last}$ 为 $0$。

## 输入

第一行，三个正整数 $n,m,q$（$1\leq n\leq 300$，$1\leq m\leq {n(n-1)\over 2}$，$1\leq q\leq 10^5$），表示图的点数，边数，以及询问次数。

接下来 $m$ 行，每行三个正整数 $a_i,b_i,w_i$（$1\leq a_i\leq n$，$1\leq b_i\leq n$，$1\leq w_i\leq 10^5$），表示第 $i$ 条边的起点，终点，以及边的长度。

接下来 $q$ 行，每行三个正整数 $u_i,v_i,s_i$（$1\leq u_i\leq n$，$1\leq v_i\leq n$，$1\leq s_i\leq n$），表示第 $i$ 次询问。

## 输出

共 $q$ 行，第 $i$ 行为一个整数，表示第 $i$ 次询问的答案。

## 输入样例

    5 6 3
    1 2 1
    2 3 2
    3 4 3
    4 5 4
    1 4 5
    2 5 6
    1 3 2
    5 4 1
    1 5 4

## 输出样例

    0
    9
    7

## 提示

+ 对于第一个询问，$\text{last}$ 为 $0$，真实询问为 $u_1=2,v_1=4,s_1=3$。无法在不经过点 $3$ 的情况下从点 $2$ 到达点 $4$，因此答案为 $0$。
+ 对于第二个询问，$\text{last}$ 为 $0$，真实询问为 $u_1=1,v_1=5,s_1=2$。在不经过点 $2$ 的情况下从点 $1$ 到达点 $5$ 的最短路径为 $1\rightarrow 4\rightarrow 5$，因此答案为 $9$。
+ 对于第三个询问，$\text{last}$ 为 $9$，真实询问为 $u_1=1,v_1=5,s_1=4$。在不经过点 $4$ 的情况下从点 $1$ 到达点 $5$ 的最短路径为 $1\rightarrow 2\rightarrow 5$，因此答案为 $7$。
