# 2024-流水线调度2

时间限制：1000 ms / 空间限制：65536 KB / 难度：5

## 题目描述

在你精心设计的流水线调度方案下，车间的收益大大提高，因此车间主管决定扩大生产，开设了许多新的流水线。

现在车间有 $n$ 条流水线，每条流水线有 $m$ 个装配站，编号都为 $1, 2, \cdots, m$，每条流水线同样编号的装配站都执行相同的功能。拼装一个成品要按顺序经过 $m$ 个装配站才能加工完成，经过第 $i$ 条流水线的第 $j$ 个装配站要花费 $p_{i,j}$ 的时间，从第 $i$ 条流水线移动到第 $j$ 条流水线要花费 $t_{i,j}$ 的时间，且进入第一个装配站时无需移动时间，请问制造一个成品**最少时间**是多少？

同时车间经理很信任你，希望你能够继续求出**具体的调度方案**，来投入真实的生产使用。若有多种流水线调度方案所需的时间相同且都为最小，选择在所有流水线调度方案中排序最小的。

流水线调度方案排序最小是指：若 $a_1, a_2, \cdots, a_m$ 与 $b_1, b_2, \cdots, b_m$ 为两个流水线调度方案 $A$ 和 $B$，分别表示在第 $i$ 个装配站上选择了第 $a_i$ 条流水线或第 $b_i$ 条流水线。我们称流水线调度方案 $A$ 的序号小于 $B$，当且仅当存在 $i \ (1 \leq i \leq m)$ 使得 $a_j = b_j \ (1 \leq j < i)$ 且 $a_i < b_i$。

## 输入格式

第一行两个正整数 $T \ (1 \leq T \leq 200)$ 表示数据组数。

接下来 $T$ 组数据：

第一行一个正整数 $m , n (1 < m \le 20, 1 < n \le 10)$，表示 $n$ 条流水线有 $m$ 个装配站。

接下来 $n$ 行，每行 $m$ 个正整数 $p_{i,1}, p_{i,2}, \cdots, p_{i,m} \ (0 \le p_{i,j} \le 10^9)$，表示经过第 $i$ 条流水线的第 $j$ 个装配站要花费的时间。

接下来 $n$ 行，每行 $n$ 个正整数 $t_{i,1}, t_{i,2}, t_{i,3}  \cdots, t_{i,n}$（$0 \le t_{i,j} \le 10^9$），表示从第 $i$ 条流水线移动到第 $j$ 条流水线所花费的时间。

## 输出格式

第一行一个非负整数，表示制造一个成品的最少时间。

接下来 $m$ 行，表示一个成品在流水线装配的具体过程，要求按装配站编号从小到大的顺序输出，输出样式形如 `Station%d: Line%d`，表示在第 $i$ 个装配站时选择第 $j$ 条流水线。

## 输入样例

    3
    3 3
    10 1 10
    8 5 10
    7 10 8
    0 2 2
    1 1 2
    1 2 3
    3 3
    1 1 10
    2 3 4
    2 2 3
    5 0 1
    4 0 0
    0 0 0
    4 4
    109977626 465759754 623612756 590236728
    561501790 570627873 652496222 80933543
    413257473 719231895 117978120 382767939
    908165124 966110829 257230685 22547303
    3 47 46 31
    36 32 39 4
    3 33 39 15
    38 7 25 50

## 输出样例

    19
    Station1: Line3
    Station2: Line1
    Station3: Line1
    7
    Station1: Line1
    Station2: Line2
    Station3: Line3
    716262867
    Station1: Line1
    Station2: Line1
    Station3: Line3
    Station4: Line4

## 样例解释

对于第二组数据：所需时间最少的方案有：依次选择流水线 $1, 2, 3$ 和 $3, 1, 2$，所需时间都为 $7$，我们选择字典序较小的 $1, 2, 3$ 作为输出方案。

## 提示

经典动态规划问题，本题所有伪代码可参考 PPT。
